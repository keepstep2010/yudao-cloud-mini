import{a as M,t as P,d as O,F as A,s as B,f as F,h as x,y as N,cJ as U,ah as $,R as C,cK as z,c as D,q as I}from"./index-SNKBwPMT.js";var g={},m={},S;function G(){if(S)return m;S=1;var v=m&&m.__awaiter||function(i,c,t,a){function n(r){return r instanceof t?r:new t(function(u){u(r)})}return new(t||(t=Promise))(function(r,u){function e(y){try{o(a.next(y))}catch(s){u(s)}}function l(y){try{o(a.throw(y))}catch(s){u(s)}}function o(y){y.done?r(y.value):n(y.value).then(e,l)}o((a=a.apply(i,c||[])).next())})},b=m&&m.__generator||function(i,c){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},a,n,r,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=e(0),u.throw=e(1),u.return=e(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function e(o){return function(y){return l([o,y])}}function l(o){if(a)throw new TypeError("Generator is already executing.");for(;u&&(u=0,o[0]&&(t=0)),t;)try{if(a=1,n&&(r=o[0]&2?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[o[0]&2,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return t.label++,{value:o[1],done:!1};case 5:t.label++,n=o[1],o=[0];continue;case 7:o=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){t=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){t.label=o[1];break}if(o[0]===6&&t.label<r[1]){t.label=r[1],r=o;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(o);break}r[2]&&t.ops.pop(),t.trys.pop();continue}o=c.call(i,t)}catch(y){o=[6,y],n=0}finally{a=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(m,"__esModule",{value:!0}),m.base64ToBlob=h;function h(i){return v(this,void 0,void 0,function(){var c,t,a;return b(this,function(n){switch(n.label){case 0:return[4,fetch(i)];case 1:return c=n.sent(),[4,c.blob()];case 2:return t=n.sent(),a=d(i),a&&(t=t.slice(0,t.size,a)),[2,t]}})})}var f=/^data:(.+);base64,/;function d(i){var c;return(c=i.match(f))===null||c===void 0?void 0:c.slice(1,2).pop()}return m}var w={},R;function W(){if(R)return w;R=1;var v=w&&w.__awaiter||function(f,d,i,c){function t(a){return a instanceof i?a:new i(function(n){n(a)})}return new(i||(i=Promise))(function(a,n){function r(l){try{e(c.next(l))}catch(o){n(o)}}function u(l){try{e(c.throw(l))}catch(o){n(o)}}function e(l){l.done?a(l.value):t(l.value).then(r,u)}e((c=c.apply(f,d||[])).next())})},b=w&&w.__generator||function(f,d){var i={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},c,t,a,n=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return n.next=r(0),n.throw=r(1),n.return=r(2),typeof Symbol=="function"&&(n[Symbol.iterator]=function(){return this}),n;function r(e){return function(l){return u([e,l])}}function u(e){if(c)throw new TypeError("Generator is already executing.");for(;n&&(n=0,e[0]&&(i=0)),i;)try{if(c=1,t&&(a=e[0]&2?t.return:e[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,e[1])).done)return a;switch(t=0,a&&(e=[e[0]&2,a.value]),e[0]){case 0:case 1:a=e;break;case 4:return i.label++,{value:e[1],done:!1};case 5:i.label++,t=e[1],e=[0];continue;case 7:e=i.ops.pop(),i.trys.pop();continue;default:if(a=i.trys,!(a=a.length>0&&a[a.length-1])&&(e[0]===6||e[0]===2)){i=0;continue}if(e[0]===3&&(!a||e[1]>a[0]&&e[1]<a[3])){i.label=e[1];break}if(e[0]===6&&i.label<a[1]){i.label=a[1],a=e;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(e);break}a[2]&&i.ops.pop(),i.trys.pop();continue}e=d.call(f,i)}catch(l){e=[6,l],t=0}finally{c=a=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}};Object.defineProperty(w,"__esModule",{value:!0}),w.base64ToFile=h;function h(f,d,i){return v(this,void 0,void 0,function(){var c,t;return b(this,function(a){switch(a.label){case 0:return[4,fetch(f)];case 1:return c=a.sent(),[4,c.blob()];case 2:return t=a.sent(),[2,new File([t],d,i)]}})})}return w}var _={},q;function k(){if(q)return _;q=1;var v=_&&_.__awaiter||function(t,a,n,r){function u(e){return e instanceof n?e:new n(function(l){l(e)})}return new(n||(n=Promise))(function(e,l){function o(p){try{s(r.next(p))}catch(T){l(T)}}function y(p){try{s(r.throw(p))}catch(T){l(T)}}function s(p){p.done?e(p.value):u(p.value).then(o,y)}s((r=r.apply(t,a||[])).next())})},b=_&&_.__generator||function(t,a){var n={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},r,u,e,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=o(0),l.throw=o(1),l.return=o(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(s){return function(p){return y([s,p])}}function y(s){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(n=0)),n;)try{if(r=1,u&&(e=s[0]&2?u.return:s[0]?u.throw||((e=u.return)&&e.call(u),0):u.next)&&!(e=e.call(u,s[1])).done)return e;switch(u=0,e&&(s=[s[0]&2,e.value]),s[0]){case 0:case 1:e=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,u=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(e=n.trys,!(e=e.length>0&&e[e.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!e||s[1]>e[0]&&s[1]<e[3])){n.label=s[1];break}if(s[0]===6&&n.label<e[1]){n.label=e[1],e=s;break}if(e&&n.label<e[2]){n.label=e[2],n.ops.push(s);break}e[2]&&n.ops.pop(),n.trys.pop();continue}s=a.call(t,n)}catch(p){s=[6,p],u=0}finally{r=e=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(_,"__esModule",{value:!0}),_.blobToBase64=h;function h(t){return v(this,void 0,void 0,function(){return b(this,function(a){return[2,typeof FileReader=="function"?d(t):c(t)]})})}var f;(function(t){t.error="error",t.loadend="loadend"})(f||(f={}));function d(t){return v(this,void 0,void 0,function(){return b(this,function(a){return[2,new Promise(function(n,r){try{var u=new FileReader,e=function(){n(u.result),u.removeEventListener(f.loadend,e)};u.addEventListener(f.loadend,e);var l=function(){r(u.error),u.removeEventListener(f.error,l)};u.addEventListener(f.error,l),u.readAsDataURL(t)}catch(o){r(o)}})]})})}var i="application/octet-stream";function c(t){return v(this,void 0,void 0,function(){var a,n,r,u;return b(this,function(e){switch(e.label){case 0:return r=(n=Buffer).from,[4,t.text()];case 1:return a=r.apply(n,[e.sent()]),u=t.type||i,[2,"data:".concat(u,";base64,").concat(a.toString("base64"))]}})})}return _}var j={},L;function J(){return L||(L=1,(function(v){Object.defineProperty(v,"__esModule",{value:!0}),v.fileToBase64=void 0;var b=k();Object.defineProperty(v,"fileToBase64",{enumerable:!0,get:function(){return b.blobToBase64}})})(j)),j}var E;function K(){return E||(E=1,(function(v){var b=g&&g.__createBinding||(Object.create?(function(f,d,i,c){c===void 0&&(c=i);var t=Object.getOwnPropertyDescriptor(d,i);(!t||("get"in t?!d.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return d[i]}}),Object.defineProperty(f,c,t)}):(function(f,d,i,c){c===void 0&&(c=i),f[c]=d[i]})),h=g&&g.__exportStar||function(f,d){for(var i in f)i!=="default"&&!Object.prototype.hasOwnProperty.call(d,i)&&b(d,f,i)};Object.defineProperty(v,"__esModule",{value:!0}),h(G(),v),h(W(),v),h(k(),v),h(J(),v)})(g)),g}var H=K(),Q=(function(v){M(b,v);function b(){return v!==null&&v.apply(this,arguments)||this}return b.prototype.uploadFile=function(h,f){return F(this,void 0,void 0,function(){var d,i,c;return x(this,function(t){switch(t.label){case 0:return d=U(f,"post"),d.data?[3,2]:(i=new FormData,[4,H.base64ToBlob(h)]);case 1:c=t.sent(),i.append("file",c,"signature.png"),d.data=i,t.label=2;case 2:return[2,this.props.env.fetcher(d,N(this.props.data,{file:h}))]}})})},b.prototype.handleChange=function(h){var f,d;return F(this,void 0,void 0,function(){var i,c,t,a,n,r,u,e;return x(this,function(l){switch(l.label){case 0:if(i=this.props,c=i.translate,t=i.uploadApi,a=i.embed,n=i.onChange,!a||!t||h===void 0)return n?.(h),[2];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.uploadFile(h,t)];case 2:if(r=l.sent(),!r.ok||r.status&&r.status!=="0"||!r.data)throw new Error(r.msg||c("File.errorRetry"));return u=r.data.value||r.data.url||r.data,n?.(u),[3,4];case 3:return e=l.sent(),n?.(""),(d=(f=this.props.env)===null||f===void 0?void 0:f.alert)===null||d===void 0||d.call(f,e.message||c("File.errorRetry")),[3,4];case 4:return[2]}})})},b.prototype.render=function(){var h=this.props,f=h.classnames,d=h.className,i=$(this.props,["value","width","height","mobileUI","embed","color","bgColor","clearBtnLabel","clearBtnIcon","undoBtnLabel","undoBtnIcon","confirmBtnLabel","confirmBtnIcon","embedConfirmLabel","embedConfirmIcon","ebmedCancelLabel","ebmedCancelIcon","embedBtnIcon","embedBtnLabel","uploadApi"]);return C.createElement(z,D({classnames:f,className:d,onChange:this.handleChange},i))},O([I,B("design:type",Function),B("design:paramtypes",[String,String]),B("design:returntype",Promise)],b.prototype,"uploadFile",null),O([I,B("design:type",Function),B("design:paramtypes",[Object]),B("design:returntype",Promise)],b.prototype,"handleChange",null),b})(C.Component),X=(function(v){M(b,v);function b(h,f){var d=v.call(this,h)||this,i=f;return i.registerComponent(d),d}return b.prototype.componentWillUnmount=function(){var h;(h=v.prototype.componentWillUnmount)===null||h===void 0||h.call(this);var f=this.context;f.unRegisterComponent(this)},b.contextType=P,b=O([A({type:"input-signature",sizeMutable:!1}),B("design:paramtypes",[Object,Object])],b),b})(Q);export{X as InputSignatureRenderer,Q as default};
