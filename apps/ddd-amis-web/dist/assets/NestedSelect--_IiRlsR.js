import{cf as se,cg as ae,ch as re,ci as le,g as ie,a as W,d as k,aZ as te,R as v,ap as oe,f as A,h as I,M as de,c as x,bJ as G,cj as M,bS as U,ck as D,cl as K,cm as ce,b7 as ue,a3 as H,ba as he,b1 as Z,cn as pe,aI as Q,I as ve,E as fe,O as me,P as ye,J as X,bb as ge,aG as Ce,S as be,bc as ke,co as Oe,K as Ne,q as F,s as l,aV as Se,cp as Fe}from"./index-SNKBwPMT.js";var $,Y;function Ee(){if(Y)return $;Y=1;var _=se(),r=ae(),e=re(),t=le(),n=r(function(a){return e(_(a,1,t,!0))});return $=n,$}var Pe=Ee();const ee=ie(Pe);var ne=(function(_){W(r,_);function r(){var e=_!==null&&_.apply(this,arguments)||this;return e.outTarget=v.createRef(),e.state={isOpened:!1,isFocused:!1,inputValue:"",stack:[e.props.options]},e}return r.prototype.domRef=function(e){this.target=e},r.prototype.componentDidUpdate=function(e){e.options!==this.props.options&&this.setState({stack:[this.props.options]})},r.prototype.doAction=function(e,t,n){var a,s,i=this.props,o=i.resetValue,d=i.onChange,c=i.formStore,h=i.store,u=i.name,m=e?.actionType;if(m==="clear")d?.("");else if(m==="reset"){var C=(s=oe((a=c?.pristine)!==null&&a!==void 0?a:h?.pristine,u))!==null&&s!==void 0?s:o;d?.(C??"")}},r.prototype.dispatchEvent=function(e,t){return t===void 0&&(t={}),A(this,void 0,void 0,function(){var n,a,s,i,o,d,c;return I(this,function(h){switch(h.label){case 0:return n=this.props,a=n.dispatchEvent,s=n.options,i=n.multiple,o=n.value,d=n.selectedOptions,[4,a(e,de(this.props,x({options:s,items:s,value:o,selectedItems:i?d:d[0]},t)))];case 1:return c=h.sent(),[2,!!c?.prevented]}})})},r.prototype.isParentNode=function(e){return Array.isArray(e.children)&&e.children.length>0},r.prototype.handleOutClick=function(e){var t;e.stopPropagation(),this.outTargetWidth=(t=this.outTarget.current)===null||t===void 0?void 0:t.clientWidth,e.defaultPrevented||this.setState(function(n){return{isOpened:!n.isOpened}})},r.prototype.handleResultClear=function(){this.setState({inputValue:void 0})},r.prototype.close=function(){this.setState({isOpened:!1})},r.prototype.removeItem=function(e,t){return A(this,void 0,void 0,function(){var n,a,s,i,o;return I(this,function(d){switch(d.label){case 0:return n=this.props,a=n.onChange,s=n.selectedOptions,t&&t.stopPropagation(),s.splice(e,1),i=this.getValue(),[4,this.dispatchEvent("change",{value:i})];case 1:return o=d.sent(),o||a(i),[2]}})})},r.prototype.renderValue=function(e,t){var n=this.props,a=n.classnames,s=n.labelField,i=n.valueField,o=n.options,d=n.hideNodePathLabel,c=this.state.inputValue||"",h=G(c);if(d)return M(e[s||"label"]);var u=U(o,e,!0),m=M(e[s||"label"]),C=" / ",V=u?u.map(function(N){return M(N[s||"label"])}).join(C):m;return v.createElement("span",{className:a("Select-valueLabel"),key:t||e[i||"value"],title:V},u?u.map(function(N,P){var y=M(N[s||"label"]),g=N[i||"value"],w=P===u.length-1;return v.createElement("span",{key:P},h.test(g)||h.test(y)?Fe(y,c):y,!w&&C)}):m)},r.prototype.handleOptionClick=function(e){return A(this,void 0,void 0,function(){var t,n,a,s,i,o,d,c,h;return I(this,function(u){switch(u.label){case 0:return t=this.props,n=t.multiple,a=t.onChange,s=t.joinValues,i=t.extractValue,o=t.valueField,d=t.onlyLeaf,n?[2]:(c=s||i?e[o||"value"]:e,c===void 0?[2]:d&&this.isParentNode(e)?[2]:[4,this.dispatchEvent("change",{value:c,selectedItems:e})]);case 1:return h=u.sent(),h||a(c),h||this.handleResultClear(),this.setState({stack:[this.props.options]}),this.close(),[2]}})})},r.prototype.handleCheck=function(e,t,n){return A(this,void 0,void 0,function(){var a,s,i,o,d,c,h,u,m,C,V,N,P,y,g,w,R,R,f,p,S,O;return I(this,function(E){switch(E.label){case 0:if(a=this.props,s=a.onChange,i=a.selectedOptions,o=a.joinValues,d=a.delimiter,c=a.extractValue,h=a.withChildren,u=a.onlyChildren,m=a.cascade,C=a.options,V=a.onlyLeaf,N=this.state.stack,P=this.props.valueField||"value",V&&!Array.isArray(e)&&this.isParentNode(e))return[2];if(!Array.isArray(e)&&e.children&&e.children.length&&typeof t=="number"&&(N[t]?N.splice(t+1,1,e.children):N.push(e.children)),y=i,w=function(b){return ue(D(Array.isArray(b)?b:[b],function(T){return T.children&&T.children.length?null:T}))},Array.isArray(e)?(h?e=D(e):u&&(e=w(e)),g=y.length===e.length?[]:e):Array.isArray(e.children)?m?g=K(y,[e]):h?(e=D([e]),R=e.every(function(b){return!!~y.indexOf(b)}),g=(R?K:ee)(y,e)):u?(e=w(e),R=e.every(function(b){return!!~y.indexOf(b)}),g=(R?K:ee)(y,e)):(g=y.filter(function(b){return!~D([e]).indexOf(b)}),!~y.indexOf(e)&&g.push(e)):g=K(y,[e]),!m)for(f=e;;){if(p=ce(C,f),p?.value&&p.children.every(function(b){return~g.indexOf(b)})){p.children.forEach(function(b){var T=g.indexOf(b);~T&&!h&&!u&&g.splice(T,1)}),u||g.push(p),f=p;continue}break}return S=o?g.map(function(b){return b[P]}).join(d):c?g.map(function(b){return b[P]}):g,[4,this.dispatchEvent("change",{value:S,selectedItems:e})];case 1:return O=E.sent(),O||s(S),O||this.handleResultClear(),n&&this.setState({stack:[this.props.options]}),[2]}})})},r.prototype.allChecked=function(e){var t=this,n=this.props,a=n.selectedOptions,s=n.withChildren,i=n.onlyChildren;return e.every(function(o){return(s||i)&&o.children?t.allChecked(o.children):a.some(function(d){return d===o})})},r.prototype.partialChecked=function(e){var t=this;return e.some(function(n){var a=n.children&&t.partialChecked(n.children);return a||t.props.selectedOptions.some(function(s){return s===n})})},r.prototype.reload=function(e,t){var n=this.props.reloadOptions;n&&n(e,t)},r.prototype.getValue=function(){var e=this.props,t=e.selectedOptions,n=e.joinValues,a=e.valueField,s=e.extractValue,i=e.delimiter,o=e.value;return n?o=t.map(function(d){return d[a||"value"]}).join(i||","):s&&(o=t.map(function(d){return d[a||"value"]})),o},r.prototype.onFocus=function(e){return A(this,void 0,void 0,function(){var t,n,a,s,i;return I(this,function(o){switch(o.label){case 0:return t=this.props,n=t.onFocus,a=t.disabled,s=this.getValue(),!a&&!this.state.isOpened?(this.setState({isFocused:!0}),[4,this.dispatchEvent("focus",{value:s})]):[3,2];case 1:i=o.sent(),i||n&&n(e),o.label=2;case 2:return[2]}})})},r.prototype.onBlur=function(e){return A(this,void 0,void 0,function(){var t,n,a;return I(this,function(s){switch(s.label){case 0:return t=this.props.onBlur,n=this.getValue(),this.setState({isFocused:!1}),[4,this.dispatchEvent("blur",{value:n})];case 1:return a=s.sent(),a||t&&t(e),[2]}})})},r.prototype.getTarget=function(){return this.target||(this.target=H.findDOMNode(this)),this.target},r.prototype.handleKeyPress=function(e){e.key===" "&&(this.handleOutClick(e),e.preventDefault())},r.prototype.handleInputKeyDown=function(e){var t=this.state.inputValue,n=this.props,a=n.multiple,s=n.selectedOptions;e.key==="Backspace"&&!t&&s.length&&a&&this.removeItem(s.length-1)},r.prototype.handleInputChange=function(e){var t=this.props,n=t.options,a=t.labelField,s=t.valueField,i=e&&this.state.isOpened?he(n,function(o,d,c,h){return!!Z([o].concat(h),e,{keys:[a||"label",s||"value"],threshold:Z.rankings.CONTAINS}).length||!!(o.children&&o.children.length)},1,!0):n.concat();this.setState({inputValue:e,stack:[i]})},r.prototype.handleResultChange=function(e){return A(this,void 0,void 0,function(){var t,n,a,s,i,o,d,c,h,u;return I(this,function(m){switch(m.label){case 0:return t=this.props,n=t.joinValues,a=t.extractValue,s=t.delimiter,i=t.valueField,o=t.onChange,d=t.multiple,c=Array.isArray(e)?e.concat():[],!d&&!c.length?[4,this.dispatchEvent("change",{value:""})]:[3,2];case 1:return h=m.sent(),h||o(""),[2];case 2:return(n||a)&&(c=e.map(function(C){return C[i||"value"]})),n&&(c=c.join(s||",")),[4,this.dispatchEvent("change",{value:c})];case 3:return u=m.sent(),u||o(c),[2]}})})},r.prototype.getMenuSelectMenuStyle=function(){var e=this.props.options,t=this.outTargetWidth,n=pe(e),a={};return t&&(a={width:t/n}),a},r.prototype.renderOptions=function(){var e=this,t=this.props,n=t.multiple,a=t.selectedOptions,s=t.classnames,i=t.options,o=t.disabled,d=t.checkAll,c=t.checkAllLabel,h=t.translate,u=t.labelField,m=t.menuClassName,C=t.cascade,V=t.onlyChildren,N=t.testIdBuilder,P=this.props.valueField||"value",y=this.state.stack,g=this.partialChecked(i),w=this.allChecked(i);return v.createElement(v.Fragment,null,y.map(function(R,f){return v.createElement("div",{key:f,className:s("NestedSelect-menu",m),style:e.getMenuSelectMenuStyle()},n&&d&&f===0?v.createElement("div",{className:s("NestedSelect-option","checkall")},v.createElement(Q,{size:"sm",onChange:e.handleCheck.bind(e,R),checked:g,partial:g&&!w}),v.createElement("span",{onClick:e.handleCheck.bind(e,R)},h(c))):null,R.map(function(p,S){var O=N?.getChild("menu-".concat(f)).getChild(p.value||S),E=U(i,p),b=E?.some(function(q){return!!~a.indexOf(q)}),T=C?!1:n&&b,j=E?.some(function(q){return!!q.disabled}),B=T||p.disabled||j||!!o,z=!!(p.children&&e.partialChecked(p.children)),L=T||!!~a.indexOf(p);!L&&V&&n&&e.isParentNode(p)&&e.allChecked(p.children)&&(L=!0);var J=M(p[u||"label"]);return v.createElement("div",{key:S,className:s("NestedSelect-option",{"is-active":!B&&(L||!C&&z)}),onMouseEnter:e.onMouseEnter.bind(e,p,f)},n?v.createElement(Q,{size:"sm",onChange:e.handleCheck.bind(e,p,f,!1),trueValue:p[P],checked:L||!C&&z,partial:!L,disabled:B,testIdBuilder:O?.getChild("checkbox")}):null,v.createElement("div",x({className:s("NestedSelect-optionLabel",{"is-disabled":B}),onClick:function(){return!B&&(n?e.handleCheck(p,f):e.handleOptionClick(p))},title:J},O?.getTestId()),J),p.children&&p.children.length?v.createElement("div",x({className:s("NestedSelect-optionArrowRight",{"is-disabled":B})},O?.getChild("arrow-right").getTestId()),v.createElement(ve,{icon:"right-arrow-bold",className:"icon"})):null)}))}))},r.prototype.renderSearchResult=function(){var e=this,t=this.state,n=t.stack,a=t.inputValue,s=this.props,i=s.classnames,o=s.translate,d=s.options,c=s.labelField,h=s.valueField,u=s.cascade,m=s.selectedOptions,C=s.multiple,V=s.disabled,N=s.onlyChildren,P=s.render,y=this.props.noResultsText;y&&(y=P("noResultText",o(y)));var g=G(a||""),w=D(n[0]).filter(function(f){return!!(g.test(f[h||"value"])||g.test(f[c||"label"]))}),R=v.createElement("div",{className:i("NestedSelect-menu"),style:this.getMenuSelectMenuStyle()},w.length?w.map(function(f,p){var S=U(d,f),O=u?!1:C&&S?.some(function(j){return!!~m.indexOf(j)}),E=O||f.disabled||!!V||S?.some(function(j){return!!j.disabled}),b=!!(f.children&&e.partialChecked(f.children)),T=O||!!~m.indexOf(f);return!T&&N&&e.isParentNode(f)&&e.allChecked(f.children)&&(T=!0),v.createElement("div",{className:i("NestedSelect-option",{"is-active":!E&&(T||!u&&b)}),key:p},v.createElement("div",{className:i("NestedSelect-optionLabel",{"is-disabled":E}),onClick:function(){!E&&(C?e.handleCheck(f,f.value,!0):e.handleOptionClick(f))}},e.renderValue(f,f.value)))}):v.createElement("div",{className:i("NestedSelect-option",{"no-result":!0})},y));return R},r.prototype.onMouseEnter=function(e,t,n){var a=this.state.stack;t=t+1;var s=e.children;s&&s.length?a[t]?a.splice(t,1,s):a.push(s):a[t]&&a.splice(t,1),this.setState({stack:a.slice(0,t+1)})},r.prototype.renderOuter=function(){var e=this,t=this.props,n=t.popOverContainer,a=t.translate,s=t.classnames,i=t.options,o=t.render,d=t.id,c=t.themeCss,h=!!this.state.inputValue,u=this.props.noResultsText;u&&(u=o("noResultText",a(u)));var m=v.createElement(fe,{disabled:!this.state.isOpened,onRootClose:this.close},function(C){return v.createElement("div",{className:s("NestedSelect-menuOuter"),ref:C},h?e.renderSearchResult():i.length?e.renderOptions():v.createElement("div",{className:s("NestedSelect-noResult")},u))});return v.createElement(me,{target:this.getTarget,container:n||(function(){return H.findDOMNode(e)}),placement:"auto",show:!0},v.createElement(ye,{className:s("NestedSelect-popover",X(x(x({},this.props),{name:"nestedSelectPopoverClassName",id:d,themeCss:c})))},m))},r.prototype.render=function(){var e,t=this.props,n=t.className,a=t.style,s=t.disabled,i=t.classnames,o=t.multiple,d=t.placeholder,c=t.translate,h=t.inline,u=t.searchable,m=t.selectedOptions,C=t.clearable,V=t.loading,N=t.borderMode,P=t.mobileUI;t.popOverContainer;var y=t.env,g=t.testIdBuilder,w=t.loadingConfig,R=t.maxTagCount,f=t.overflowTagPopover,p=this.props,S=p.classPrefix,O=p.themeCss,E=p.id;return v.createElement("div",{className:i("NestedSelectControl",n),ref:this.outTarget,style:a},v.createElement(ge,{mobileUI:P,maxTagCount:R,overflowTagPopover:f,disabled:s,ref:this.domRef,placeholder:c(d??"placeholder.empty"),inputPlaceholder:"",className:i("NestedSelect",(e={"NestedSelect--inline":h,"NestedSelect--single":!o,"NestedSelect--multi":o,"NestedSelect--searchable":u,"is-opened":this.state.isOpened,"is-focused":this.state.isFocused},e["NestedSelect--border".concat(Ce(N))]=N,e),X(x(x({},this.props),{name:"nestedSelectControlClassName",id:E,themeCss:O}))),result:o?m:m.length?m[0]:"",onResultClick:this.handleOutClick,value:this.state.inputValue,onChange:this.handleInputChange,onResultChange:this.handleResultChange,onClear:this.handleResultClear,itemRender:this.renderValue,onKeyPress:this.handleKeyPress,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.handleInputKeyDown,clearable:C,hasDropDownArrow:!0,allowInput:u&&!P,testIdBuilder:g},V?v.createElement(be,{loadingConfig:w,size:"sm"}):void 0),P?v.createElement(ke,{className:i("NestedSelect-popup"),container:y.getModalContainer,isShow:this.state.isOpened,onHide:this.close,showConfirm:!1,showClose:!1},v.createElement(Oe,x({onClose:this.close},this.props,{onChange:this.handleResultChange,options:this.props.options.slice(),value:m}))):this.state.isOpened?this.renderOuter():null,v.createElement(Ne,x({},this.props,{config:{themeCss:O,classNames:[{key:"nestedSelectControlClassName",weights:{hover:{suf:".is-clickable:not(.is-disabled)"},focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"nestedSelectPopoverClassName",weights:{default:{suf:" .".concat(S,"NestedSelect-option")},hover:{suf:" .".concat(S,"NestedSelect-option.is-highlight")},focused:{inner:".".concat(S,"NestedSelect-option.is-active")}}}],id:E},env:y})))},r.defaultProps={cascade:!1,withChildren:!1,onlyChildren:!1,onlyLeaf:!1,searchPromptText:"Select.searchPromptText",noResultsText:"noResult",checkAll:!0,checkAllLabel:"Select.checkAll",hideNodePathLabel:!1},k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],r.prototype,"domRef",null),k([F,l("design:type",Function),l("design:paramtypes",[String,Object]),l("design:returntype",Promise)],r.prototype,"dispatchEvent",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],r.prototype,"handleOutClick",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],r.prototype,"handleResultClear",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],r.prototype,"close",null),k([F,l("design:type",Function),l("design:paramtypes",[Object,Object]),l("design:returntype",void 0)],r.prototype,"renderValue",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],r.prototype,"handleOptionClick",null),k([F,l("design:type",Function),l("design:paramtypes",[Object,Number,Boolean]),l("design:returntype",Promise)],r.prototype,"handleCheck",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],r.prototype,"getValue",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],r.prototype,"onFocus",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],r.prototype,"onBlur",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],r.prototype,"getTarget",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],r.prototype,"handleKeyPress",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],r.prototype,"handleInputKeyDown",null),k([F,l("design:type",Function),l("design:paramtypes",[String]),l("design:returntype",void 0)],r.prototype,"handleInputChange",null),k([F,l("design:type",Function),l("design:paramtypes",[Array]),l("design:returntype",Promise)],r.prototype,"handleResultChange",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],r.prototype,"getMenuSelectMenuStyle",null),k([Se(),l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],r.prototype,"render",null),r})(v.Component),Re=(function(_){W(r,_);function r(){return _!==null&&_.apply(this,arguments)||this}return r=k([te({type:"nested-select"})],r),r})(ne),Te=(function(_){W(r,_);function r(){return _!==null&&_.apply(this,arguments)||this}return r=k([te({type:"cascader-select"})],r),r})(ne);export{Te as CascaderSelectControlRenderer,Re as NestedSelectControlRenderer,ne as default};
