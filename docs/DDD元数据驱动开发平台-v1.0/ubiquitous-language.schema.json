{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/ddd-metamodel/1.0/ubiquitous-language.schema.json",
  "title": "统一语言定义",
  "description": "领域统一语言定义 - 重构版 v2.0",
  "version": "2.0.0",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "模式版本",
      "const": "2.0.0"
    },
    "domainId": {
      "type": "string",
      "pattern": "^domain_[a-zA-Z0-9_]+$",
      "description": "所属领域ID"
    },
    "businessTerms": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/businessTerm"
      },
      "minItems": 1,
      "description": "业务术语列表"
    },
    "businessAttributes": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/businessAttribute"
      },
      "description": "业务属性列表"
    },
    "businessRules": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/businessRule"
      },
      "description": "业务规则列表"
    },
    "termRelationships": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/termRelationship"
      },
      "description": "术语关系列表"
    }
  },
  "required": ["version", "domainId", "businessTerms"],
  "additionalProperties": false,
  "$defs": {
    "businessTerm": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^term_[a-zA-Z0-9_]+$",
          "description": "术语唯一标识符"
        },
        "name": {
          "type": "string",
          "description": "术语名称",
          "minLength": 1
        },
        "englishName": {
          "type": "string",
          "description": "英文名称"
        },
        "description": {
          "type": "string",
          "description": "术语详细描述"
        },
        "category": {
          "type": "string",
          "enum": ["DOMAIN_CONCEPT", "BUSINESS_PROCESS", "BUSINESS_RULE", "BUSINESS_EVENT", "BUSINESS_VALUE"],
          "description": "术语分类"
        },
        "boundedContextId": {
          "type": "string",
          "pattern": "^bc_[a-zA-Z0-9_]+$",
          "description": "所属限界上下文ID"
        },
        "attributes": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^attr_[a-zA-Z0-9_]+$"
          },
          "description": "关联的业务属性ID列表"
        },
        "relatedTerms": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^term_[a-zA-Z0-9_]+$"
          },
          "description": "相关术语ID列表"
        },
        "examples": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "术语示例列表"
        },
        "businessRules": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^rule_[a-zA-Z0-9_]+$"
          },
          "description": "相关业务规则ID列表"
        },
        "synonyms": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "同义词列表"
        },
        "antonyms": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "反义词列表"
        },
        "usageNotes": {
          "type": "string",
          "description": "使用说明"
        },
        "isCore": {
          "type": "boolean",
          "description": "是否为核心术语"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "maximum": 5,
          "description": "优先级（1-5，5为最高）"
        }
      },
      "required": ["id", "name", "description", "category"],
      "additionalProperties": false
    },
    "businessAttribute": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^attr_[a-zA-Z0-9_]+$",
          "description": "业务属性唯一标识符"
        },
        "name": {
          "type": "string",
          "description": "属性名称",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "description": "属性详细描述"
        },
        "dataType": {
          "type": "string",
          "enum": ["String", "Integer", "Long", "Double", "Boolean", "BigDecimal", "LocalDate", "LocalDateTime", "LocalTime", "Enum", "Custom"],
          "description": "数据类型"
        },
        "customType": {
          "type": "string",
          "description": "自定义类型名称（当dataType为Custom时使用）"
        },
        "unit": {
          "type": "string",
          "description": "单位（如：元、个、米等）"
        },
        "format": {
          "type": "string",
          "description": "格式（如：yyyy-MM-dd、#,##0.00等）"
        },
        "constraints": {
          "$ref": "#/$defs/constraints"
        },
        "defaultValue": {
          "description": "默认值"
        },
        "isRequired": {
          "type": "boolean",
          "description": "是否必填"
        },
        "isUnique": {
          "type": "boolean",
          "description": "是否唯一"
        },
        "isReadOnly": {
          "type": "boolean",
          "description": "是否只读"
        },
        "validationRules": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "验证规则列表"
        },
        "businessLogic": {
          "type": "string",
          "description": "业务逻辑描述"
        },
        "examples": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "示例值列表"
        }
      },
      "required": ["id", "name", "description", "dataType"],
      "additionalProperties": false
    },
    "businessRule": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^rule_[a-zA-Z0-9_]+$",
          "description": "业务规则唯一标识符"
        },
        "name": {
          "type": "string",
          "description": "规则名称",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "description": "规则详细描述"
        },
        "category": {
          "type": "string",
          "enum": ["VALIDATION", "CALCULATION", "WORKFLOW", "PERMISSION", "BUSINESS_LOGIC"],
          "description": "规则分类"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "maximum": 5,
          "description": "优先级（1-5，5为最高）"
        },
        "expression": {
          "type": "string",
          "description": "规则表达式"
        },
        "parameters": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ruleParameter"
          },
          "description": "规则参数列表"
        },
        "conditions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "触发条件列表"
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "执行动作列表"
        },
        "errorMessage": {
          "type": "string",
          "description": "错误提示信息"
        },
        "warningMessage": {
          "type": "string",
          "description": "警告提示信息"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否启用"
        },
        "effectiveDate": {
          "type": "string",
          "format": "date",
          "description": "生效日期"
        },
        "expiryDate": {
          "type": "string",
          "format": "date",
          "description": "失效日期"
        },
        "relatedTerms": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^term_[a-zA-Z0-9_]+$"
          },
          "description": "相关术语ID列表"
        },
        "relatedAttributes": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^attr_[a-zA-Z0-9_]+$"
          },
          "description": "相关属性ID列表"
        }
      },
      "required": ["id", "name", "description", "category", "expression"],
      "additionalProperties": false
    },
    "ruleParameter": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "参数名称"
        },
        "type": {
          "type": "string",
          "description": "参数类型"
        },
        "description": {
          "type": "string",
          "description": "参数描述"
        },
        "defaultValue": {
          "description": "默认值"
        },
        "isRequired": {
          "type": "boolean",
          "description": "是否必需"
        }
      },
      "required": ["name", "type"],
      "additionalProperties": false
    },
    "termRelationship": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^rel_[a-zA-Z0-9_]+$",
          "description": "关系唯一标识符"
        },
        "sourceTermId": {
          "type": "string",
          "pattern": "^term_[a-zA-Z0-9_]+$",
          "description": "源术语ID"
        },
        "targetTermId": {
          "type": "string",
          "pattern": "^term_[a-zA-Z0-9_]+$",
          "description": "目标术语ID"
        },
        "relationshipType": {
          "type": "string",
          "enum": ["COMPOSITION", "AGGREGATION", "GENERALIZATION", "REALIZATION", "DEPENDENCY", "ASSOCIATION", "ENUMERATION", "SYNONYM", "ANTONYM", "HYPONYM", "HYPERNYM"],
          "description": "关系类型"
        },
        "description": {
          "type": "string",
          "description": "关系描述"
        },
        "cardinality": {
          "type": "string",
          "enum": ["ONE_TO_ONE", "ONE_TO_MANY", "MANY_TO_ONE", "MANY_TO_MANY", "ZERO_TO_ONE", "ZERO_TO_MANY"],
          "description": "关系基数"
        },
        "businessContext": {
          "type": "string",
          "description": "业务上下文描述"
        },
        "isBidirectional": {
          "type": "boolean",
          "description": "是否双向关系"
        },
        "reverseRelationshipId": {
          "type": "string",
          "pattern": "^rel_[a-zA-Z0-9_]+$",
          "description": "反向关系ID"
        },
        "constraints": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "关系约束列表"
        }
      },
      "required": ["id", "sourceTermId", "targetTermId", "relationshipType"],
      "additionalProperties": false
    },
    "constraints": {
      "type": "object",
      "properties": {
        "minLength": {
          "type": "integer",
          "minimum": 0,
          "description": "最小长度"
        },
        "maxLength": {
          "type": "integer",
          "minimum": 1,
          "description": "最大长度"
        },
        "pattern": {
          "type": "string",
          "description": "正则表达式模式"
        },
        "minimum": {
          "type": "number",
          "description": "最小值"
        },
        "maximum": {
          "type": "number",
          "description": "最大值"
        },
        "exclusiveMinimum": {
          "type": "boolean",
          "description": "是否排除最小值"
        },
        "exclusiveMaximum": {
          "type": "boolean",
          "description": "是否排除最大值"
        },
        "enumValues": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "枚举值列表"
        },
        "precision": {
          "type": "integer",
          "minimum": 0,
          "description": "数值精度"
        },
        "scale": {
          "type": "integer",
          "minimum": 0,
          "description": "数值小数位数"
        },
        "customValidation": {
          "type": "string",
          "description": "自定义验证逻辑"
        }
      },
      "additionalProperties": false
    }
  }
}