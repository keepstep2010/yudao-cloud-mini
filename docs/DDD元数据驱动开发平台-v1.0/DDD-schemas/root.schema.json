{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/ddd-metamodel/2.0/root.schema.json",
  "title": "DDD元数据模型根定义",
  "description": "领域驱动设计元数据完整定义 - v2.0",
  "version": "2.0.0",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "元模型版本",
      "const": "2.0.0"
    },
    "projectMetadata": {
      "$ref": "./project-metadata.schema.json"
    },
    "metadata": {
      "$ref": "#/$defs/metadata"
    },
    "domain": {
      "$ref": "#/$defs/domain"
    },
    "ubiquitousLanguage": {
      "$ref": "./ubiquitous-language.schema.json"
    },
    "strategicDesign": {
      "$ref": "./strategic-design.schema.json"
    },
    "tacticalDesign": {
      "$ref": "./tactical-design.schema.json"
    },
    "dataTransferObjects": {
      "$ref": "./data-transfer-objects.schema.json"
    },
    "implementationMapping": {
      "$ref": "./implementation-mapping.schema.json"
    },
    "screenDefinition": {
      "$ref": "./screen-definition.schema.json"
    },
    "amisScreenDefinition": {
      "$ref": "./amis-screen-definition.schema.json"
    },
    "relationships": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/relationship"
      },
      "description": "Schema间关系定义"
    },
    "validation": {
      "$ref": "#/$defs/validation"
    },
    "isActive": {
      "type": "boolean",
      "description": "是否激活"
    }
  },
  "required": ["version", "projectMetadata", "metadata", "domain", "ubiquitousLanguage", "strategicDesign", "tacticalDesign"],
  "additionalProperties": false,
  "$defs": {
    "metadata": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^metadata_[a-zA-Z0-9_]+$",
          "description": "元数据ID"
        },
        "name": {
          "type": "string",
          "description": "元数据名称"
        },
        "description": {
          "type": "string",
          "description": "元数据描述"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "创建时间"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "更新时间"
        },
        "createdBy": {
          "type": "string",
          "description": "创建者"
        },
        "updatedBy": {
          "type": "string",
          "description": "更新者"
        },
        "version": {
          "type": "string",
          "description": "版本号"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "标签列表"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否激活"
        }
      },
      "required": ["id", "name", "version"],
      "additionalProperties": false
    },
    "domain": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^domain_[a-zA-Z0-9_]+$",
          "description": "领域ID"
        },
        "name": {
          "type": "string",
          "description": "领域名称"
        },
        "description": {
          "type": "string",
          "description": "领域描述"
        },
        "type": {
          "type": "string",
          "enum": ["CORE", "SUPPORTING", "GENERIC"],
          "description": "领域类型"
        },
        "boundedContexts": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^bc_[a-zA-Z0-9_]+$"
          },
          "description": "限界上下文ID列表"
        },
        "stakeholders": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/stakeholder"
          },
          "description": "利益相关者列表"
        },
        "businessGoals": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/businessGoal"
          },
          "description": "业务目标列表"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否激活"
        }
      },
      "required": ["id", "name", "type"],
      "additionalProperties": false
    },
    "stakeholder": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^stakeholder_[a-zA-Z0-9_]+$",
          "description": "利益相关者ID"
        },
        "name": {
          "type": "string",
          "description": "利益相关者名称"
        },
        "description": {
          "type": "string",
          "description": "利益相关者描述"
        },
        "type": {
          "type": "string",
          "enum": ["BUSINESS_USER", "TECHNICAL_USER", "MANAGER", "CUSTOMER", "PARTNER"],
          "description": "利益相关者类型"
        },
        "contact": {
          "type": "object",
          "properties": {
            "email": {
              "type": "string",
              "format": "email"
            },
            "phone": {
              "type": "string"
            }
          },
          "description": "联系信息"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否激活"
        }
      },
      "required": ["id", "name", "type"],
      "additionalProperties": false
    },
    "businessGoal": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^goal_[a-zA-Z0-9_]+$",
          "description": "业务目标ID"
        },
        "name": {
          "type": "string",
          "description": "业务目标名称"
        },
        "description": {
          "type": "string",
          "description": "业务目标描述"
        },
        "priority": {
          "type": "string",
          "enum": ["HIGH", "MEDIUM", "LOW"],
          "description": "优先级"
        },
        "metrics": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/metric"
          },
          "description": "度量指标列表"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否激活"
        }
      },
      "required": ["id", "name", "priority"],
      "additionalProperties": false
    },
    "metric": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^metric_[a-zA-Z0-9_]+$",
          "description": "度量指标ID"
        },
        "name": {
          "type": "string",
          "description": "度量指标名称"
        },
        "description": {
          "type": "string",
          "description": "度量指标描述"
        },
        "type": {
          "type": "string",
          "enum": ["KPI", "KVI", "CUSTOM"],
          "description": "度量指标类型"
        },
        "unit": {
          "type": "string",
          "description": "单位"
        },
        "target": {
          "type": "number",
          "description": "目标值"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否激活"
        }
      },
      "required": ["id", "name", "type"],
      "additionalProperties": false
    },
    "relationship": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^relationship_[a-zA-Z0-9_]+$",
          "description": "关系ID"
        },
        "name": {
          "type": "string",
          "description": "关系名称"
        },
        "description": {
          "type": "string",
          "description": "关系描述"
        },
        "sourceSchema": {
          "type": "string",
          "description": "源Schema"
        },
        "targetSchema": {
          "type": "string",
          "description": "目标Schema"
        },
        "sourceElement": {
          "type": "string",
          "description": "源元素"
        },
        "targetElement": {
          "type": "string",
          "description": "目标元素"
        },
        "type": {
          "type": "string",
          "enum": ["REFERENCE", "INHERITANCE", "COMPOSITION", "AGGREGATION", "ASSOCIATION"],
          "description": "关系类型"
        },
        "cardinality": {
          "type": "string",
          "enum": ["ONE_TO_ONE", "ONE_TO_MANY", "MANY_TO_ONE", "MANY_TO_MANY"],
          "description": "基数"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否激活"
        }
      },
      "required": ["id", "name", "sourceSchema", "targetSchema", "type"],
      "additionalProperties": false
    },
    "validation": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^validation_[a-zA-Z0-9_]+$",
          "description": "验证配置ID"
        },
        "crossSchemaValidation": {
          "type": "boolean",
          "description": "是否启用跨Schema验证"
        },
        "businessRuleValidation": {
          "type": "boolean",
          "description": "是否启用业务规则验证"
        },
        "consistencyValidation": {
          "type": "boolean",
          "description": "是否启用一致性验证"
        },
        "rules": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/validationRule"
          },
          "description": "验证规则列表"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否激活"
        }
      },
      "required": ["id"],
      "additionalProperties": false
    },
    "validationRule": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^validation_rule_[a-zA-Z0-9_]+$",
          "description": "验证规则ID"
        },
        "name": {
          "type": "string",
          "description": "验证规则名称"
        },
        "description": {
          "type": "string",
          "description": "验证规则描述"
        },
        "type": {
          "type": "string",
          "enum": ["CROSS_SCHEMA", "BUSINESS_RULE", "CONSISTENCY", "CUSTOM"],
          "description": "验证规则类型"
        },
        "expression": {
          "type": "string",
          "description": "验证表达式"
        },
        "severity": {
          "type": "string",
          "enum": ["ERROR", "WARNING", "INFO"],
          "description": "严重程度"
        },
        "message": {
          "type": "string",
          "description": "验证消息"
        },
        "isActive": {
          "type": "boolean",
          "description": "是否激活"
        }
      },
      "required": ["id", "name", "type", "expression"],
      "additionalProperties": false
    }
  }
}