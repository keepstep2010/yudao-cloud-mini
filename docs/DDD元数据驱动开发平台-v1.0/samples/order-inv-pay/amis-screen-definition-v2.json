{
  "version": "2.0.0",
  "boundedContextId": "bc_order_inv_pay",
  "screens": [
    {
      "id": "screen_order_list",
      "name": "订单列表",
      "description": "订单管理主页面，基于DDD模型自动生成",
      "type": "LIST",
      "route": "/orders",
      "permissions": ["order:read", "order:write"],
      "amisPage": {
        "type": "page",
        "title": "订单管理",
        "body": {
          "type": "crud",
          "api": "/api/orders",
          "columns": [
            {
              "name": "id",
              "label": "订单ID",
              "type": "text"
            },
            {
              "name": "orderNumber",
              "label": "订单编号",
              "type": "text"
            },
            {
              "name": "customerName",
              "label": "客户名称",
              "type": "text"
            },
            {
              "name": "totalAmount",
              "label": "订单金额",
              "type": "currency"
            },
            {
              "name": "status",
              "label": "订单状态",
              "type": "mapping"
            },
            {
              "name": "createTime",
              "label": "创建时间",
              "type": "datetime"
            }
          ],
          "headerToolbar": [
            {
              "type": "button",
              "label": "新增订单",
              "level": "primary",
              "actionType": "dialog"
            }
          ]
        }
      },
      "modelBindings": [
        {
          "modelType": "DTO",
          "modelId": "dto_order_list_response",
          "bindingType": "TABLE_COLUMNS",
          "componentPath": "columns",
          "mappingRules": [
            {
              "sourceField": "id",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "text",
                "sortable": true,
                "searchable": true
              }
            },
            {
              "sourceField": "orderNumber",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "text",
                "sortable": true,
                "searchable": true
              }
            },
            {
              "sourceField": "customerName",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "text",
                "searchable": true
              }
            },
            {
              "sourceField": "totalAmount",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "currency",
                "sortable": true,
                "format": "¥#,##0.00"
              }
            },
            {
              "sourceField": "status",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "mapping",
                "map": {
                  "PENDING": "待处理",
                  "CONFIRMED": "已确认",
                  "SHIPPED": "已发货",
                  "DELIVERED": "已送达",
                  "CANCELLED": "已取消"
                }
              }
            },
            {
              "sourceField": "createTime",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "datetime",
                "sortable": true,
                "format": "YYYY-MM-DD HH:mm:ss"
              }
            }
          ]
        },
        {
          "modelType": "DTO",
          "modelId": "dto_order_create",
          "bindingType": "FORM_FIELDS",
          "componentPath": "headerToolbar.0.dialog.body.fields",
          "mappingRules": [
            {
              "sourceField": "orderNumber",
              "targetField": "name",
              "transformation": "DIRECT",
              "validation": {
                "type": "required",
                "message": "订单编号不能为空"
              },
              "amisProps": {
                "type": "input-text",
                "label": "订单编号",
                "required": true,
                "placeholder": "请输入订单编号"
              }
            },
            {
              "sourceField": "customerName",
              "targetField": "name",
              "transformation": "DIRECT",
              "validation": {
                "type": "required",
                "message": "客户名称不能为空"
              },
              "amisProps": {
                "type": "input-text",
                "label": "客户名称",
                "required": true,
                "placeholder": "请输入客户名称"
              }
            },
            {
              "sourceField": "totalAmount",
              "targetField": "name",
              "transformation": "DIRECT",
              "validation": {
                "type": "required",
                "message": "订单金额不能为空"
              },
              "amisProps": {
                "type": "input-number",
                "label": "订单金额",
                "required": true,
                "min": 0,
                "precision": 2
              }
            },
            {
              "sourceField": "status",
              "targetField": "name",
              "transformation": "DIRECT",
              "validation": {
                "type": "required",
                "message": "订单状态不能为空"
              },
              "amisProps": {
                "type": "select",
                "label": "订单状态",
                "required": true,
                "value": "PENDING",
                "options": [
                  {"label": "待处理", "value": "PENDING"},
                  {"label": "已确认", "value": "CONFIRMED"},
                  {"label": "已发货", "value": "SHIPPED"},
                  {"label": "已送达", "value": "DELIVERED"},
                  {"label": "已取消", "value": "CANCELLED"}
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "id": "screen_order_detail",
      "name": "订单详情",
      "description": "订单详情页面，基于DDD聚合根自动生成",
      "type": "DETAIL",
      "route": "/orders/:id",
      "permissions": ["order:read"],
      "amisPage": {
        "type": "page",
        "title": "订单详情",
        "body": {
          "type": "form",
          "api": "/api/orders/${id}",
          "fields": [
            {
              "type": "group",
              "label": "基本信息",
              "body": [
                {
                  "type": "grid",
                  "columns": [
                    {
                      "type": "static",
                      "name": "orderNumber",
                      "label": "订单编号"
                    },
                    {
                      "type": "static",
                      "name": "customerName",
                      "label": "客户名称"
                    }
                  ]
                },
                {
                  "type": "grid",
                  "columns": [
                    {
                      "type": "static",
                      "name": "totalAmount",
                      "label": "订单金额"
                    },
                    {
                      "type": "static",
                      "name": "status",
                      "label": "订单状态"
                    }
                  ]
                }
              ]
            },
            {
              "type": "group",
              "label": "订单明细",
              "body": {
                "type": "table",
                "source": "${orderItems}",
                "columns": [
                  {
                    "name": "productName",
                    "label": "产品名称"
                  },
                  {
                    "name": "quantity",
                    "label": "数量"
                  },
                  {
                    "name": "unitPrice",
                    "label": "单价"
                  },
                  {
                    "name": "subtotal",
                    "label": "小计"
                  }
                ]
              }
            }
          ]
        }
      },
      "modelBindings": [
        {
          "modelType": "AGGREGATE",
          "modelId": "aggregate_order",
          "bindingType": "FORM_FIELDS",
          "componentPath": "fields.0.body.0.columns",
          "mappingRules": [
            {
              "sourceField": "orderNumber",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "static",
                "label": "订单编号"
              }
            },
            {
              "sourceField": "customerName",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "static",
                "label": "客户名称"
              }
            }
          ]
        },
        {
          "modelType": "AGGREGATE",
          "modelId": "aggregate_order",
          "bindingType": "FORM_FIELDS",
          "componentPath": "fields.0.body.1.columns",
          "mappingRules": [
            {
              "sourceField": "totalAmount",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "static",
                "label": "订单金额"
              }
            },
            {
              "sourceField": "status",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "static",
                "label": "订单状态"
              }
            }
          ]
        },
        {
          "modelType": "VALUE_OBJECT",
          "modelId": "value_object_order_item",
          "bindingType": "TABLE_COLUMNS",
          "componentPath": "fields.1.body.columns",
          "mappingRules": [
            {
              "sourceField": "productName",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "text"
              }
            },
            {
              "sourceField": "quantity",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "number"
              }
            },
            {
              "sourceField": "unitPrice",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "currency",
                "format": "¥#,##0.00"
              }
            },
            {
              "sourceField": "subtotal",
              "targetField": "name",
              "transformation": "DIRECT",
              "amisProps": {
                "type": "currency",
                "format": "¥#,##0.00"
              }
            }
          ]
        }
      ]
    }
  ],
  "modelMappings": [
    {
      "modelType": "DTO",
      "modelId": "dto_order_list_response",
      "autoGeneration": {
        "enabled": true,
        "templates": ["LIST_TABLE", "SEARCH_FORM"],
        "defaults": {
          "tableProps": {
            "sortable": true,
            "searchable": true,
            "pageable": true
          },
          "searchProps": {
            "placeholder": "搜索订单...",
            "clearable": true
          }
        }
      },
      "amisDefaults": {
        "text": {
          "type": "text",
          "searchable": true
        },
        "number": {
          "type": "number",
          "sortable": true
        },
        "currency": {
          "type": "currency",
          "format": "¥#,##0.00",
          "sortable": true
        },
        "datetime": {
          "type": "datetime",
          "format": "YYYY-MM-DD HH:mm:ss",
          "sortable": true
        },
        "status": {
          "type": "mapping",
          "map": {
            "PENDING": "待处理",
            "CONFIRMED": "已确认",
            "SHIPPED": "已发货",
            "DELIVERED": "已送达",
            "CANCELLED": "已取消"
          }
        }
      }
    },
    {
      "modelType": "DTO",
      "modelId": "dto_order_create",
      "autoGeneration": {
        "enabled": true,
        "templates": ["CRUD_FORM"],
        "defaults": {
          "formProps": {
            "mode": "horizontal",
            "labelWidth": 120
          },
          "fieldProps": {
            "required": true,
            "clearable": true
          }
        }
      },
      "amisDefaults": {
        "string": {
          "type": "input-text",
          "required": true,
          "clearable": true
        },
        "number": {
          "type": "input-number",
          "required": true,
          "min": 0
        },
        "decimal": {
          "type": "input-number",
          "required": true,
          "min": 0,
          "precision": 2
        },
        "enum": {
          "type": "select",
          "required": true,
          "clearable": true
        }
      }
    },
    {
      "modelType": "AGGREGATE",
      "modelId": "aggregate_order",
      "autoGeneration": {
        "enabled": true,
        "templates": ["DETAIL_VIEW", "CRUD_FORM"],
        "defaults": {
          "detailProps": {
            "mode": "readonly",
            "layout": "horizontal"
          }
        }
      },
      "amisDefaults": {
        "id": {
          "type": "static",
          "label": "ID"
        },
        "string": {
          "type": "static",
          "label": "文本"
        },
        "number": {
          "type": "static",
          "label": "数字"
        },
        "decimal": {
          "type": "static",
          "label": "金额",
          "format": "¥#,##0.00"
        },
        "datetime": {
          "type": "static",
          "label": "时间",
          "format": "YYYY-MM-DD HH:mm:ss"
        }
      }
    },
    {
      "modelType": "VALUE_OBJECT",
      "modelId": "value_object_order_item",
      "autoGeneration": {
        "enabled": true,
        "templates": ["TABLE_COLUMNS"],
        "defaults": {
          "tableProps": {
            "bordered": true,
            "striped": true
          }
        }
      },
      "amisDefaults": {
        "string": {
          "type": "text"
        },
        "number": {
          "type": "number"
        },
        "decimal": {
          "type": "currency",
          "format": "¥#,##0.00"
        }
      }
    }
  ],
  "amisConfig": {
    "theme": "antd",
    "locale": "zh-CN",
    "timezone": "Asia/Shanghai",
    "validations": {
      "required": {
        "message": "此字段为必填项"
      },
      "minLength": {
        "message": "至少需要{min}个字符"
      },
      "pattern": {
        "message": "格式不正确"
      }
    }
  }
}

