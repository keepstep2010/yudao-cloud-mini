{
  "version": "1.0.0",
  "boundedContextId": "bc_order",
  "dtoMappings": [
    {
      "dtoId": "dto_create_order_cmd",
      "className": "CreateOrderCommand",
      "packageName": "com.example.order.application.dto.command",
      "layer": "APPLICATION",
      "annotations": ["@Value", "@Builder"],
      "serializationConfig": {
        "format": "JSON",
        "library": "JACKSON",
        "includeTypeInfo": false
      },
      "validationConfig": {
        "framework": "JSR380",
        "groups": ["CreateOrder"],
        "validateOnBuild": true
      },
      "builderConfig": {
        "generateBuilder": true,
        "builderName": "CreateOrderCommandBuilder",
        "builderMethod": "builder",
        "toBuilder": true
      },
      "attributes": [
        {
          "attributeName": "customerId",
          "fieldName": "customerId",
          "fieldType": "String",
          "annotations": ["@NotBlank", "@Size(max = 36)"],
          "getter": true,
          "setter": false,
          "validationAnnotations": ["@NotBlank", "@Size(max = 36)"],
          "isFinal": true
        },
        {
          "attributeName": "items",
          "fieldName": "items",
          "fieldType": "List<OrderItemDto>",
          "annotations": ["@Valid", "@NotEmpty"],
          "getter": true,
          "setter": false,
          "validationAnnotations": ["@Valid", "@NotEmpty"],
          "isFinal": true
        },
        {
          "attributeName": "totalAmount",
          "fieldName": "totalAmount",
          "fieldType": "BigDecimal",
          "annotations": ["@DecimalMin(value = \"0.0\")", "@Digits(integer = 10, fraction = 2)"],
          "getter": true,
          "setter": false,
          "validationAnnotations": ["@DecimalMin(value = \"0.0\")", "@Digits(integer = 10, fraction = 2)"],
          "isFinal": true
        }
      ]
    },
    {
      "dtoId": "dto_order_response",
      "className": "OrderResponse",
      "packageName": "com.example.order.application.dto.response",
      "layer": "CLIENT",
      "annotations": ["@Data"],
      "serializationConfig": {
        "format": "JSON",
        "library": "JACKSON"
      },
      "attributes": [
        {
          "attributeName": "orderId",
          "fieldName": "orderId",
          "fieldType": "String",
          "getter": true,
          "setter": true
        },
        {
          "attributeName": "status",
          "fieldName": "status",
          "fieldType": "String",
          "getter": true,
          "setter": true
        },
        {
          "attributeName": "totalAmount",
          "fieldName": "totalAmount",
          "fieldType": "BigDecimal",
          "getter": true,
          "setter": true
        }
      ]
    }
  ],
  "colaArchitecture": {
    "clientLayer": [
      {
        "name": "OrderServiceApi",
        "type": "INTERFACE",
        "methods": ["createOrder", "getOrderById", "cancelOrder"]
      },
      {
        "name": "CreateOrderCommand",
        "type": "DTO",
        "implements": "Serializable"
      },
      {
        "name": "OrderResponse",
        "type": "DTO",
        "implements": "Serializable"
      }
    ],
    "adapterLayer": [
      {
        "name": "OrderController",
        "type": "CLASS",
        "implements": "OrderServiceApi",
        "annotations": ["@RestController", "@RequestMapping(\"/api/orders\")"],
        "methods": ["createOrder", "getOrderById", "cancelOrder"]
      }
    ],
    "appLayer": [
      {
        "name": "OrderAppService",
        "type": "INTERFACE",
        "methods": ["createOrder", "getOrderById", "cancelOrder"]
      },
      {
        "name": "OrderAppServiceImpl",
        "type": "CLASS",
        "implements": "OrderAppService",
        "annotations": ["@Service"],
        "methods": ["createOrder", "getOrderById", "cancelOrder"]
      },
      {
        "name": "CreateOrderCommandExecutor",
        "type": "CLASS",
        "annotations": ["@Component"],
        "methods": ["execute"]
      }
    ],
    "domainLayer": [
      {
        "name": "OrderEntity",
        "type": "CLASS",
        "annotations": ["@Entity", "@Table(name = \"t_order\")"],
        "methods": ["createOrder", "cancelOrder", "calculateTotalAmount"]
      },
      {
        "name": "OrderRepository",
        "type": "INTERFACE",
        "annotations": [],
        "methods": ["findById", "save", "findByCustomerId"]
      }
    ],
    "infrastructureLayer": [
      {
        "name": "OrderRepositoryImpl",
        "type": "CLASS",
        "implements": "OrderRepository",
        "annotations": ["@Repository"],
        "methods": ["findById", "save", "findByCustomerId"]
      },
      {
        "name": "OrderCreatedEventPublisher",
        "type": "CLASS",
        "annotations": ["@Component"],
        "methods": ["publish"]
      }
    ]
  },
  "persistenceMapping": [
    {
      "entityName": "OrderEntity",
      "tableName": "t_order",
      "attributes": [
        {
          "attributeName": "orderId",
          "columnName": "order_id",
          "columnType": "VARCHAR(32)",
          "primaryKey": true,
          "nullable": false
        },
        {
          "attributeName": "status",
          "columnName": "status",
          "columnType": "VARCHAR(20)",
          "nullable": false
        },
        {
          "attributeName": "totalAmount",
          "columnName": "total_amount",
          "columnType": "DECIMAL(10,2)",
          "nullable": false
        },
        {
          "attributeName": "customerId",
          "columnName": "customer_id",
          "columnType": "VARCHAR(36)",
          "nullable": false
        }
      ]
    }
  ],
  "integrationMapping": [
    {
      "targetContextId": "bc_inventory",
      "protocol": "REST",
      "endpoints": [
        {
          "name": "预留库存",
          "url": "/api/inventory/reserve",
          "method": "POST",
          "request": [
            {
              "name": "items",
              "type": "List<InventoryReserveItem>",
              "required": true
            }
          ],
          "response": [
            {
              "name": "success",
              "type": "Boolean"
            }
          ],
          "fallback": "InventoryServiceFallback"
        }
      ]
    },
    {
      "targetContextId": "bc_payment",
      "protocol": "REST",
      "endpoints": [
        {
          "name": "创建支付",
          "url": "/api/payments",
          "method": "POST",
          "request": [
            {
              "name": "orderId",
              "type": "String",
              "required": true
            },
            {
              "name": "amount",
              "type": "BigDecimal",
              "required": true
            }
          ],
          "response": [
            {
              "name": "paymentId",
              "type": "String"
            },
            {
              "name": "paymentUrl",
              "type": "String"
            }
          ],
          "fallback": "PaymentServiceFallback"
        }
      ]
    }
  ]
}